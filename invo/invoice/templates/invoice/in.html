<!DOCTYPE html>
<html>
{%load static%}
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>invo | invoice </title>
    <link rel="icon" type="image/x-icon" href="{%static 'public/img/invo.png'%}">
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="{%static 'public/css/styleDB.css'%}">
    <link href="{%static 'public/css/stylesPop.css'%}" rel="stylesheet">
  <script defer src="{%static 'public/js/scriptPop.js'%}"></script>
</head>

<body>
    <div class="wrapper">
        <aside id="sidebar" style="background-color: black;">
            <div class="d-flex">
                <button class="toggle-btn" type="button">
                    <i class="lni lni-grid-alt"></i>
                </button>
                <div class="sidebar-logo">
                    <a href="#" style="font-size: larger;">invo</a>
                </div>
            </div>
            <ul class="sidebar-nav">
                
                <li class="sidebar-item">
                    <a href="{% url 'dashboard:dashboard' %}" class="sidebar-link">
                        <i class="lni lni-home"></i>
                        <span>dashboard</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="{% url 'invoice:invoice' %}" class="sidebar-link">
                        <i class="lni lni-ticket-alt"></i>
                        <span>invoices</span>
                    </a>
                </li>
                <li class="sidebar-item">
                  <a href="{% url 'invoice:customers' %}" class="sidebar-link">
                      <i class="lni lni-target-customer"></i>
                      <span>customers</span>
                  </a>
              </li>
                <li class="sidebar-item">
                    <a href="{% url 'management:sellers' %}" class="sidebar-link">
                        <i class="lni lni-users"></i>
                        <span>sellers</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="{% url 'management:items' %}" class="sidebar-link">
                        <i class="lni lni-cart-full"></i>
                        <span>items</span>
                    </a>
                </li>
               </li>
                <li class="sidebar-item">
                    <a href="{% url 'management:expenses' %}" class="sidebar-link">
                        <i class="lni lni-dollar"></i>
                        <span>expenses</span>
                    </a>
                </li>
            </ul>
            <div class="sidebar-footer">
                <a href="{% url 'dashboard:logout' %}" class="sidebar-link">
                    <i class="lni lni-exit"></i>
                    <span>Logout</span>
                </a>
            </div>
        </aside>
        <div class="main ">
          <div class="command-line  ">
            <nav class="navbar navbar-expand px-4 py-3" style="background : #D8D2D1; ">
                <form action="#" class="d-none d-sm-inline-block">
                    <div class="sort-invoce" >
                        
                                <div class="btn-group " >
                                    <button type="button" class="btn btn-danger dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: #D8D2D1; border: #D8D2D1; font-size: larger;">
                                         Invoices 
                                    </button>
                                    <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#">All</a></li>
                                    <li><a class="dropdown-item" href="#">Last 10 days</a></li>
                                    <li><a class="dropdown-item" href="#">Viewed</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="#">+ Add sort</a></li>
                                    </ul>
                                </div>
                    </div>
                </form>

                <button class="btn btn-danger" id="open-popup">New +</button>
                
            </nav>
        </div>

        <section style="padding-top: 1%;">
          <div>
            <div class="center">
              
              </div>

              <div class="popup" id="popup">
                
              <div class="overlay"></div>
              <div class="popup-content">
              <h2> New invoice</h2>
              <div style="width: 50%; padding-left:3%;">
                <div class="form-group">
                    <label for="exampleFormControlSelect">Select customer:</label>
                    <input type="text" class="form-control" id="searchInput" placeholder="Search...">
                    <select class="form-control" id="exampleFormControlSelect">
                      <option>Option 1</option>
                      <option>Option 2</option>
                      <option>Option 3</option>
                      <option>Option 4</option>
                      <option>Option 5</option>
                      <option>Option 6</option>
                      <option>Option 7</option>
                      <option>Option 8</option>
                      <option>Option 9</option>
                      <option>Option 10</option>
                    </select>
                  </div>
                  <div>
                    <h4> Invoice# : 0000000000</h4>
                  </div>
                  <div>
                    <h4> Invoice DATE : 27-3-28</h4>
                  </div> 
                  <div>
                    <h4>
                        <hr class="dropdown-divider">
                    </h4>
                  </div>
                  <div>
                    <h4> Item table :</h4>
                  </div> 



                  <div>

                    <style>
                        table {
                          border-collapse: collapse;
                          width: 100%;
                        }
                    
                        th, td {
                          border: 1px solid #dddddd;
                          text-align: left;
                          padding: 8px;
                        }
                    
                        th {
                          background-color: #f2f2f2;
                        }
                    
                        td {
                          background-color: #ffffff;
                        }
                    
                        td[contenteditable="true"] {
                          background-color: #ffffcc;
                        }
                      </style>
                    
                    
                    <table id="editableTable">
                      <thead>
                        <tr>
                          <th>Item</th>
                          <th>Quantity</th> <!-- Changed from "Email" to "Quantity" -->
                          <th>AMOUNT</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td contenteditable="false">
                            <select class="form-control">
                              <option value="item1">Item 1</option>
                              <option value="item2">Item 2</option>
                              <option value="item3">Item 3</option>
                            </select>
                          </td>
                          <td contenteditable="true">
                            <input type="number" class="form-control" min="0" step="1">
                          </td> <!-- Changed to input type number -->
                          <td contenteditable="true"></td>
                          <td><button onclick="deleteRow(this)">Delete</button></td>
                        </tr>
                        <tr>
                          <td contenteditable="false">
                            <select class="form-control">
                              <option value="item1">Item 1</option>
                              <option value="item2">Item 2</option>
                              <option value="item3">Item 3</option>
                            </select>
                          </td>
                          <td contenteditable="true">
                            <input type="number" class="form-control" min="0" step="1">
                          </td> <!-- Changed to input type number -->
                          <td contenteditable="true"></td>
                          <td><button onclick="deleteRow(this)">Delete</button></td>
                        </tr>
                      </tbody>
                    </table>
                    
                    <button onclick="addRow()">Add Row</button>
                    
                    <script>
                      function addRow() {
                        var table = document.getElementById("editableTable").getElementsByTagName('tbody')[0];
                        var newRow = table.insertRow(table.rows.length);
                        var cells = ['Item', 'Quantity', 'Phone']; // Define cell values for new row
                        for (var i = 0; i < cells.length; i++) {
                          var cell = newRow.insertCell(i);
                          if (i === 0) { // For the "Item" column
                            var selectElement = document.createElement('select');
                            selectElement.className = "form-control";
                            selectElement.innerHTML = `
                              <option value="item1">Item 1</option>
                              <option value="item2">Item 2</option>
                              <option value="item3">Item 3</option>
                            `;
                            cell.appendChild(selectElement);
                          } else if (i === 1) { // For the "Quantity" column
                            var inputElement = document.createElement('input');
                            inputElement.type = "number";
                            inputElement.className = "form-control";
                            inputElement.min = "0";
                            inputElement.step = "1";
                            cell.appendChild(inputElement);
                          } else {
                            cell.contentEditable = true;
                            cell.textContent = ''; // Set initial text content to empty
                          }
                        }
                        var deleteButtonCell = newRow.insertCell(cells.length);
                        var deleteButton = document.createElement('button');
                        deleteButton.textContent = 'Delete';
                        deleteButton.setAttribute('onclick', 'deleteRow(this)');
                        deleteButtonCell.appendChild(deleteButton);
                      }
                    
                      function deleteRow(button) {
                        var row = button.parentNode.parentNode;
                        row.parentNode.removeChild(row);
                      }
                    </script>
                  </div>
                </div>
              <div class="controls">
              <button class="close-btn">Close</button>
              <button class="submit-btn">Submit</button>
              </div>
              </div>
              </div>
          </div>
        </section>
      
        <section>
          <div class="container">
            <style>
              table {
                border-collapse: collapse;
                width: 100%;
              }
          
              th, td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
              }
          
              th {
                cursor: pointer;
              }
          
              tr:nth-child(even) {
                background-color: #f2f2f2;
              }
          
              input[type=text] {
                width: 100%;
                padding: 12px 20px;
                margin: 8px 0;
                box-sizing: border-box;
              }
          
              button {
                margin-top: 10px;
              }
            </style>
             <div style="width: 30%; "><input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Search by Customer Name..."> </div>
             <table id="invoiceTable">
               <thead>
                 <tr>
                   <th onclick="sortTable(0)">Invoice Number</th>
                   <th onclick="sortTable(1)">Date</th>
                   <th onclick="sortTable(2)">Order Number</th>
                   <th onclick="sortTable(3)">Customer Name</th>
                   <th onclick="sortTable(4)">Status</th>
                   <th onclick="sortTable(5)">Amount</th>
                 </tr>
               </thead>
               <tbody>
                 <!-- Table rows will be populated dynamically using JavaScript -->
               </tbody>
             </table>
           
             <button onclick="exportToPDF()">Export to PDF</button>
             <button onclick="copyTable()">Copy Table</button>
           
             <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
             <script>
               let invoices = [
                 { 
                   "Invoice Number": "INV-001",
                   "Date": "2024-03-15",
                   "Order Number": "ORD-001",
                   "Customer Name": "John Doe",
                   "Status": "Paid",
                   "Amount": "$200"
                 },
                 { 
                   "Invoice Number": "INV-002",
                   "Date": "2024-03-14",
                   "Order Number": "ORD-002",
                   "Customer Name": "Jane Smith",
                   "Status": "Pending",
                   "Amount": "$150"
                 },
                 { 
                   "Invoice Number": "INV-003",
                   "Date": "2024-03-13",
                   "Order Number": "ORD-003",
                   "Customer Name": "Alice Johnson",
                   "Status": "Paid",
                   "Amount": "$300"
                 }
               ];
           
               function generateTable(data) {
                 const tbody = document.querySelector('#invoiceTable tbody');
                 tbody.innerHTML = '';
                 data.forEach(invoice => {
                   const row = document.createElement('tr');
                   Object.values(invoice).forEach(value => {
                     const cell = document.createElement('td');
                     cell.textContent = value;
                     row.appendChild(cell);
                   });
                   tbody.appendChild(row);
                 });
               }
           
               function sortTable(colIndex) {
                 const dataType = typeof invoices[0][Object.keys(invoices[0])[colIndex]];
                 invoices.sort((a, b) => {
                   let valueA = a[Object.keys(a)[colIndex]];
                   let valueB = b[Object.keys(b)[colIndex]];
                   if (dataType === 'string') {
                     valueA = valueA.toUpperCase();
                     valueB = valueB.toUpperCase();
                   }
                   if (valueA < valueB) return -1;
                   if (valueA > valueB) return 1;
                   return 0;
                 });
                 generateTable(invoices);
               }
           
               function searchTable() {
                 const input = document.getElementById('searchInput');
                 const filter = input.value.toUpperCase();
                 const rows = document.querySelectorAll('#invoiceTable tbody tr');
                 rows.forEach(row => {
                   const customerNameCell = row.cells[3];
                   const customerName = customerNameCell.textContent.toUpperCase();
                   if (customerName.indexOf(filter) > -1) {
                     row.style.display = '';
                   } else {
                     row.style.display = 'none';
                   }
                 });
               }
           
               function exportToPDF() {
                 const doc = new jsPDF();
                 doc.autoTable({
                   html: '#invoiceTable',
                   styles: { 
                     cellPadding: 1, 
                     fontSize: 10 
                   }
                 });
                 doc.save('invoice_data.pdf');
               }
           
               function copyTable() {
                 const table = document.getElementById('invoiceTable');
                 const range = document.createRange();
                 range.selectNode(table);
                 window.getSelection().removeAllRanges();
                 window.getSelection().addRange(range);
                 document.execCommand('copy');
                 window.getSelection().removeAllRanges();
                 alert('Table copied to clipboard.');
               }
           
               // Populate invoices array and generate table
               generateTable(invoices);
             </script>
          </div>
        </section>
        
        
        
</div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src="{%static 'public/js/scriptDB.js'%}"></script>
</body>

</html>